<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ember.input &#8212; Ember 1.5.0b1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinxdoc.css?v=d59dc883" />
    <script src="../../_static/documentation_options.js?v=b7825e20"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Ember 1.5.0b1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ember.input</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ember.input</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A set of classes for specifying input parameters for the Ember solver.</span>

<span class="sd">Create a :class:`.Config` object to be passed to :func:`~ember.utils.run` or</span>
<span class="sd">:func:`~ember.utils.multirun`.</span>
<span class="sd">Sane defaults are given for most input parameters. Create a customized</span>
<span class="sd">configuration by passing :class:`.Options` objects to the constructor for</span>
<span class="sd">:class:`.Config`::</span>

<span class="sd">    conf = Config(</span>
<span class="sd">        Paths(outputDir=&quot;somewhere&quot;),</span>
<span class="sd">        InitialCondition(equivalenceRatio=0.9))</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">cantera</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_ember</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">output</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">_stringTypes</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">,)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">_stringTypes</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)</span>

<div class="viewcode-block" id="Option">
<a class="viewcode-back" href="../../input.html#ember.input.Option">[docs]</a>
<span class="k">class</span> <span class="nc">Option</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instances of this class are used as class members of descendants of class</span>
<span class="sd">    :class:`Options` to represent a single configurable value. When a</span>
<span class="sd">    user-specified value for an option is specified (as a keyword argument to</span>
<span class="sd">    the constructor of a class derived from :class:`Options`), that value is</span>
<span class="sd">    stored in this object and validated to make sure it satisfies any</span>
<span class="sd">    applicable constraints.</span>

<span class="sd">    :param default:</span>
<span class="sd">        The default value for this option</span>
<span class="sd">    :param choices:</span>
<span class="sd">        A sequence of valid values for this option, e.g. ``[&#39;Mix&#39;, &#39;Multi&#39;]``.</span>
<span class="sd">        The *default* choice is automatically included in *choices*.</span>
<span class="sd">    :param min:</span>
<span class="sd">        The minimum valid value for this option</span>
<span class="sd">    :param max:</span>
<span class="sd">        The maximum valid value for this option</span>
<span class="sd">    :param nullable:</span>
<span class="sd">        Set to *True* if *None* is a valid value for this option, regardless</span>
<span class="sd">        of any other restrictions. Automatically set to *True* if *default* is</span>
<span class="sd">        *None*.</span>
<span class="sd">    :param label:</span>
<span class="sd">        A human readable label to be used in the GUI in place of the attribute</span>
<span class="sd">        name to which this Option is assigned.</span>
<span class="sd">    :param level:</span>
<span class="sd">        A number from 0-3 indicating the obscurity level of this option. Used</span>
<span class="sd">        to selectively hide advanced options in the GUI. 0 is always shown.</span>
<span class="sd">        3 is never shown.</span>
<span class="sd">    :param filter:</span>
<span class="sd">        A function that takes a :class:`Config` object as an argument and</span>
<span class="sd">        returns *True* if this option should be enabled</span>

<span class="sd">    Requiring values of a particular type is done by using one of the derived</span>
<span class="sd">    classes: :class:`StringOption`, :class:`BoolOption`, :class:`IntegerOption`,</span>
<span class="sd">    :class:`FloatOption`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># used to preserve options in the order they are defined</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">default</span>
        <span class="k">if</span> <span class="n">choices</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">choices</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isSet</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">nullable</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="nb">filter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> not in </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Value (</span><span class="si">%s</span><span class="s1">) must be greater than or equal to </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Value (</span><span class="si">%s</span><span class="s1">) must be less than or equal to </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="c1"># python2</span>

    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="c1"># python3</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span>

    <span class="k">def</span> <span class="nf">shouldBeEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conf</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">conf</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>



<div class="viewcode-block" id="StringOption">
<a class="viewcode-back" href="../../input.html#ember.input.StringOption">[docs]</a>
<span class="k">class</span> <span class="nc">StringOption</span><span class="p">(</span><span class="n">Option</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An option whose value must be a string. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">_stringTypes</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nullable</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s1">&#39;Value must be a string. Got </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">Option</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>



<div class="viewcode-block" id="BoolOption">
<a class="viewcode-back" href="../../input.html#ember.input.BoolOption">[docs]</a>
<span class="k">class</span> <span class="nc">BoolOption</span><span class="p">(</span><span class="n">Option</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An option whose value must be a boolean value. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nullable</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s1">&#39;Value must be a boolean. Got </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">Option</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>



<div class="viewcode-block" id="IntegerOption">
<a class="viewcode-back" href="../../input.html#ember.input.IntegerOption">[docs]</a>
<span class="k">class</span> <span class="nc">IntegerOption</span><span class="p">(</span><span class="n">Option</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An option whose value must be a integer. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nullable</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s1">&#39;Value must be an integer. Got </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">Option</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>



<div class="viewcode-block" id="FloatOption">
<a class="viewcode-back" href="../../input.html#ember.input.FloatOption">[docs]</a>
<span class="k">class</span> <span class="nc">FloatOption</span><span class="p">(</span><span class="n">Option</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An option whose value must be a floating point number. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nullable</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s1">&#39;Value must be a number. Got </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">Option</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>



<div class="viewcode-block" id="Options">
<a class="viewcode-back" href="../../input.html#ember.input.Options">[docs]</a>
<span class="k">class</span> <span class="nc">Options</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Base class for elements of :class:`.Config` &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Copy the defaults from the class&#39;s dictionary</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

        <span class="c1"># Apply the options specified in kwargs</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="n">opt</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
                    <span class="n">opt</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="n">opt</span><span class="o">.</span><span class="n">isSet</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">message</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Invalid option specified for </span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">:</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                                         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Unrecognized configuration option: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stringify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">spaces</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;isSet&#39;</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">default</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">value</span><span class="o">.</span><span class="n">default</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">spaces</span><span class="p">:</span>
                <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="n">indent</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span>
                <span class="n">spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">header</span> <span class="o">=</span> <span class="n">spaces</span>

            <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">=</span><span class="si">%s</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
            <span class="n">ans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">return</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">allOpts</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                   <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Option</span><span class="p">)]</span>
        <span class="n">allOpts</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sortValue</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">allOpts</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>

<div class="viewcode-block" id="Options.isSet">
<a class="viewcode-back" href="../../input.html#ember.input.Options.isSet">[docs]</a>
    <span class="k">def</span> <span class="nf">isSet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns True if the named option has a user-specified value &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span><span class="o">.</span><span class="n">isSet</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span><span class="o">.</span><span class="n">isSet</span></div>
</div>



<span class="c1"># frequently-used filter predicates</span>
<span class="k">def</span> <span class="nf">_isPremixed</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">conf</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;premixed&#39;</span>


<span class="k">def</span> <span class="nf">_isDiffusion</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">conf</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;diffusion&#39;</span>


<span class="k">def</span> <span class="nf">_isSymmetric</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">conf</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">flameGeometry</span> <span class="o">==</span> <span class="s1">&#39;cylindrical&#39;</span> <span class="ow">or</span> <span class="n">conf</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">twinFlame</span>


<span class="k">def</span> <span class="nf">_usingCvode</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">conf</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">chemistryIntegrator</span> <span class="o">==</span> <span class="s1">&#39;cvode&#39;</span>


<span class="k">def</span> <span class="nf">_usingQss</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">conf</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">chemistryIntegrator</span> <span class="o">==</span> <span class="s1">&#39;qss&#39;</span>


<span class="c1"># Dynamically decide on the default file extension: Use HDF5 if h5py is</span>
<span class="c1"># available, otherwise default to npz</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">h5py</span>
    <span class="n">dynamicDefaultFileExtension</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s1">&#39;h5&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;npz&#39;</span><span class="p">,))</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">dynamicDefaultFileExtension</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s1">&#39;npz&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;h5&#39;</span><span class="p">,))</span>


<div class="viewcode-block" id="Paths">
<a class="viewcode-back" href="../../input.html#ember.input.Paths">[docs]</a>
<span class="k">class</span> <span class="nc">Paths</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Directories for input and output files &quot;&quot;&quot;</span>

    <span class="c1">#: Relative path to the directory where output files (outNNNNNN.h5,</span>
    <span class="c1">#: profNNNNNN.h5) will be stored. Automatically created if it doesn&#39;t</span>
    <span class="c1">#: already exist.</span>
    <span class="n">outputDir</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;run/test1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Output Directory&#39;</span><span class="p">)</span>

    <span class="c1">#: File to use for log messages. If *None*, write output to stdout</span>
    <span class="n">logFile</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Log file&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="General">
<a class="viewcode-back" href="../../input.html#ember.input.General">[docs]</a>
<span class="k">class</span> <span class="nc">General</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; High-level configuration options &quot;&quot;&quot;</span>

    <span class="c1">#: True if the temperature and mass fractions on the burned gas</span>
    <span class="c1">#: side of the flame should be held constant. Applicable only to</span>
    <span class="c1">#: premixed flames. The default is *True* for twin or curved flames with</span>
    <span class="c1">#: burned gas at x=0, and *False* otherwise.</span>
    <span class="n">fixedBurnedVal</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isPremixed</span><span class="p">)</span>

    <span class="c1">#: True if the position of the leftmost grid point should be held</span>
    <span class="c1">#: constant. Should usually be True for Twin and Curved flame</span>
    <span class="c1">#: configurations.</span>
    <span class="n">fixedLeftLocation</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isSymmetric</span><span class="p">)</span>

    <span class="c1">#: Geometry specification for the flame. Options are: &#39;planar&#39;, &#39;cylindrical&#39;,</span>
    <span class="c1">#: and &#39;disc.&#39;</span>
    <span class="n">flameGeometry</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;planar&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;cylindrical&quot;</span><span class="p">,</span><span class="s2">&quot;disc&quot;</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: True if solving a planar flame that is symmetric about the x = 0 plane.</span>
    <span class="n">twinFlame</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span>
        <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">conf</span><span class="p">:</span> <span class="n">conf</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">flameGeometry</span> <span class="o">!=</span> <span class="s1">&#39;cylindrical&#39;</span><span class="p">)</span>

    <span class="c1">#: Input file (HDF5 format) containing the interpolation data needed for</span>
    <span class="c1">#: the quasi2d mode. Contains:</span>
    <span class="c1">#:</span>
    <span class="c1">#: - vector *r* (length *N*)</span>
    <span class="c1">#: - vector *z* (length *M*)</span>
    <span class="c1">#: - Temperature array *T* (size *N* x *M*)</span>
    <span class="c1">#: - radial velocity array *vr* (size *N* x *M*)</span>
    <span class="c1">#: - axial velocity array *vz* (size *N* x *M*)</span>
    <span class="n">interpFile</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">conf</span><span class="p">:</span> <span class="n">conf</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;quasi2d&#39;</span><span class="p">)</span>

    <span class="c1">#: *True* if the unburned fuel/air mixture should be used as the</span>
    <span class="c1">#: left boundary condition. Applicable only to premixed flames.</span>
    <span class="n">unburnedLeft</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isPremixed</span><span class="p">)</span>

    <span class="c1">#: *True* if the fuel mixture should be used as the left boundary</span>
    <span class="c1">#: condition. Applicable only to diffusion flames.</span>
    <span class="n">fuelLeft</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isDiffusion</span><span class="p">)</span>

    <span class="c1">#: Method for setting the boundary condition for the continuity equation</span>
    <span class="c1">#: Valid options are: ``fixedLeft``, ``fixedRight``, ``fixedQdot``,</span>
    <span class="c1">#: ``fixedTemperature``, and ``stagnationPoint``. The ``fixedTemperature``</span>
    <span class="c1">#: condition holds the location where the midpoint temperature is reached</span>
    <span class="c1">#: constant, while the other options fix the value of V at the specified</span>
    <span class="c1">#: point.</span>
    <span class="n">continuityBC</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;fixedLeft&quot;</span><span class="p">,</span>
                                <span class="p">(</span><span class="s2">&quot;fixedRight&quot;</span><span class="p">,</span> <span class="s2">&quot;fixedQdot&quot;</span><span class="p">,</span> <span class="s2">&quot;fixedTemperature&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;stagnationPoint&quot;</span><span class="p">),</span>
                                <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Integrator to use for the chemical source terms. Choices are</span>
    <span class="c1">#: ``qss`` (explicit, quasi-steady state) and ``cvode`` (implicit,</span>
    <span class="c1">#: variable-order BDF).</span>
    <span class="n">chemistryIntegrator</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;qss&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;cvode&quot;</span><span class="p">,),</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Method to use for splitting the convection / diffusion / reaction</span>
    <span class="c1">#: terms. Options are ``strang`` and ``balanced``.</span>
    <span class="n">splittingMethod</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;balanced&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;strang&quot;</span><span class="p">,),</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Number of integration failures to tolerate in the chemistry</span>
    <span class="c1">#: integrator before aborting.</span>
    <span class="n">errorStopCount</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Number of threads to use for evaluating terms in parallel</span>
    <span class="n">nThreads</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of Processors&#39;</span><span class="p">)</span>

    <span class="c1">#: Order of Chebyshev polynomial to use in approximating input</span>
    <span class="c1">#: functions over a single global time step.</span>
    <span class="n">chebyshevOrder</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div>



<div class="viewcode-block" id="Chemistry">
<a class="viewcode-back" href="../../input.html#ember.input.Chemistry">[docs]</a>
<span class="k">class</span> <span class="nc">Chemistry</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Settings pertaining to the Cantera mechanism file &quot;&quot;&quot;</span>

    <span class="c1">#: Path to the Cantera mechanism file in XML format</span>
    <span class="n">mechanismFile</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;gri30.yaml&quot;</span><span class="p">)</span>

    <span class="c1">#: ID of the phase to use in the mechanism file.</span>
    <span class="c1">#: Found on a line that looks like::</span>
    <span class="c1">#:</span>
    <span class="c1">#:     &lt;phase dim=&quot;3&quot; id=&quot;gas&quot;&gt;</span>
    <span class="c1">#:</span>
    <span class="c1">#: in the mechanism file. This is always &quot;gas&quot; for mechanisms converted</span>
    <span class="c1">#: using ck2cti and cti2ctml. This option only needs to be specified if</span>
    <span class="c1">#: the desired phase is not the first phase defined in the input file.</span>
    <span class="n">phaseID</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Transport model to use. Valid options are ``Mix``, ``Multi``, ``UnityLewis``, and ``Approx``</span>
    <span class="n">transportModel</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;Approx&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;Mix&quot;</span><span class="p">,</span> <span class="s2">&quot;Multi&quot;</span><span class="p">,</span> <span class="s2">&quot;UnityLewis&quot;</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Kinetics model to use. Valid options are ``standard`` and ``interp``.</span>
    <span class="n">kineticsModel</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;interp&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">,),</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Mole fraction threshold for including species with ``transportModel = &quot;Approx&quot;``</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Approx. transport threshold&#39;</span><span class="p">,</span>
        <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">conf</span><span class="p">:</span> <span class="n">conf</span><span class="o">.</span><span class="n">chemistry</span><span class="o">.</span><span class="n">transportModel</span> <span class="o">==</span> <span class="s1">&#39;Approx&#39;</span><span class="p">)</span>

    <span class="c1">#: Set a scalar multiplier for the reaction rate term as a function time</span>
    <span class="n">rateMultiplierFunction</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div>



<div class="viewcode-block" id="Grid">
<a class="viewcode-back" href="../../input.html#ember.input.Grid">[docs]</a>
<span class="k">class</span> <span class="nc">Grid</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Parameters controlling the adaptive grid &quot;&quot;&quot;</span>
    <span class="c1">#: Maximum relative scalar variation of each state vector</span>
    <span class="c1">#: component between consecutive grid points. For high accuracy,</span>
    <span class="c1">#: ``vtol = 0.08``; For minimal accuracy, ``vtol = 0.20``.</span>
    <span class="n">vtol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.12</span><span class="p">)</span>

    <span class="c1">#: Maximum relative variation of the gradient of each state vector</span>
    <span class="c1">#: component between consecutive grid points. For high accuracy,</span>
    <span class="c1">#: ``dvtol = 0.12``; For minimal accuracy, ``dvtol = 0.4``.</span>
    <span class="n">dvtol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="c1">#: Relative tolerance (compared to vtol and dvtol) for grid point removal.</span>
    <span class="n">rmTol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Parameter to limit numerical diffusion in regions with high</span>
    <span class="c1">#: convective velocities.</span>
    <span class="n">dampConst</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Minimum grid spacing [m]</span>
    <span class="n">gridMin</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">5e-7</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Maximum grid spacing [m]</span>
    <span class="n">gridMax</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">2e-4</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Maximum ratio of the distances between adjacent pairs of grid</span>
    <span class="c1">#: points.</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. math:: \frac{1}{\tt uniformityTol} &lt; \frac{x_{j+1}-x_j}{x_j-x_{j-1}}</span>
    <span class="c1">#:           &lt; {\tt uniformityTol}</span>
    <span class="n">uniformityTol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: State vector components smaller than this value are not</span>
    <span class="c1">#: considered whether to add or remove a grid point.</span>
    <span class="n">absvtol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Tolerance for each state vector component for extending the</span>
    <span class="c1">#: domain to satisfy zero-gradient conditions at the left and</span>
    <span class="c1">#: right boundaries.</span>
    <span class="n">boundaryTol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">5e-5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Tolerance for removing points at the boundary. Must be smaller</span>
    <span class="c1">#: than boundaryTol.</span>
    <span class="n">boundaryTolRm</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: For unstrained flames, number of flame thicknesses (based on</span>
    <span class="c1">#: reaction zone width) downstream of the flame to keep the right</span>
    <span class="c1">#: edge of the domain.</span>
    <span class="n">unstrainedDownstreamWidth</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Number of points to add when extending a boundary to satisfy</span>
    <span class="c1">#: boundaryTol.</span>
    <span class="n">addPointCount</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: For curved or twin flames, the minimum position of the first</span>
    <span class="c1">#: grid point past x = 0.</span>
    <span class="n">centerGridMin</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isSymmetric</span><span class="p">)</span></div>



<div class="viewcode-block" id="InitialCondition">
<a class="viewcode-back" href="../../input.html#ember.input.InitialCondition">[docs]</a>
<span class="k">class</span> <span class="nc">InitialCondition</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Settings controlling the initial condition for the integrator. If</span>
<span class="sd">    no restartFile is specified, an initial profile is created based</span>
<span class="sd">    on the specified fuel and oxidizer compositions.</span>

<span class="sd">    If an input file is specified, then setting fuel and oxidizer</span>
<span class="sd">    compositions will cause new values to be used only at the</span>
<span class="sd">    boundaries of the domain.</span>

<span class="sd">    The grid parameters are only used if no restart file is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: Read initial profiles from the specified file, or if &#39;None&#39;,</span>
    <span class="c1">#: create a new initial profile.</span>
    <span class="n">restartFile</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: &quot;premixed&quot;, &quot;diffusion&quot;, or &quot;quasi2d&quot;</span>
    <span class="n">flameType</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s1">&#39;premixed&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;diffusion&#39;</span><span class="p">,</span> <span class="s1">&#39;quasi2d&#39;</span><span class="p">))</span>

    <span class="c1">#: Temperature of the unburned fuel/air mixture for premixed flames [K].</span>
    <span class="n">Tu</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reactant Temperature&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isPremixed</span><span class="p">)</span>

    <span class="c1">#: Temperature of the fuel mixture for diffusion flames [K].</span>
    <span class="n">Tfuel</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fuel Temperature&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isDiffusion</span><span class="p">)</span>

    <span class="c1">#: Temperature of the oxidizer mixture for diffusion flames [K].</span>
    <span class="n">Toxidizer</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Oxidizer Temperature&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isDiffusion</span><span class="p">)</span>

    <span class="c1">#: Molar composition of the fuel mixture.</span>
    <span class="n">fuel</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="s2">&quot;CH4:1.0&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Molar Fuel Composition&#39;</span><span class="p">)</span>

    <span class="c1">#: Molar composition of the oxidizer mixture.</span>
    <span class="n">oxidizer</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="s2">&quot;N2:3.76, O2:1.0&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Molar Oxidizer Composition&#39;</span><span class="p">)</span>

    <span class="c1">#: Equivalence ratio of the fuel/air mixture for premixed flames.</span>
    <span class="n">equivalenceRatio</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Equivalence Ratio&#39;</span><span class="p">,</span>
        <span class="nb">filter</span><span class="o">=</span><span class="n">_isPremixed</span><span class="p">)</span>

    <span class="c1">#: Molar composition of the fuel + oxidizer mixture. Specify as an alternative</span>
    <span class="c1">#: to providing fuel and oxidizer compositions and equivalence ratio.</span>
    <span class="n">reactants</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Molar Reactant Composition&#39;</span><span class="p">)</span>

    <span class="c1">#: Molar composition of the flow opposite the premixed reactant</span>
    <span class="c1">#: stream, if different from the equilibrium composition</span>
    <span class="n">counterflow</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Composition of counterflow&#39;</span><span class="p">,</span>
                               <span class="nb">filter</span><span class="o">=</span><span class="n">_isPremixed</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Temperature of the flow opposite the premixed reactant stream, if</span>
    <span class="c1">#: different from the equilibrium temperature</span>
    <span class="n">Tcounterflow</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Temperature of counteflow&#39;</span><span class="p">,</span>
                               <span class="nb">filter</span><span class="o">=</span><span class="n">_isPremixed</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Adjust the composition of the counterflow stream so that the components</span>
    <span class="c1">#: are at equilibrium. This option specifies the property pair to hold</span>
    <span class="c1">#: constant during equilibration, or *False* to skip equilibration. The</span>
    <span class="c1">#: boundary condition is not consistent if this mixture has reactions that</span>
    <span class="c1">#: are proceeding at finite rates. For diffusion flames, this option is applied</span>
    <span class="c1">#: to the state of the oxidizer stream.</span>
    <span class="n">equilibrateCounterflow</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;HP&#39;</span><span class="p">,</span><span class="s1">&#39;UV&#39;</span><span class="p">,</span><span class="s1">&#39;SV&#39;</span><span class="p">,</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span><span class="s1">&#39;SP&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Equilibrate specified counterflow mixture&#39;</span><span class="p">,</span>
                                    <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Thermodynamic pressure [Pa]</span>
    <span class="n">pressure</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">101325</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">#: Number of points in the initial uniform grid.</span>
    <span class="n">nPoints</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Position of the leftmost point of the initial grid.</span>
    <span class="n">xLeft</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="o">-</span><span class="mf">0.002</span><span class="p">)</span>

    <span class="c1">#: Position of the rightmost point of the initial grid.</span>
    <span class="n">xRight</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.002</span><span class="p">)</span>

    <span class="c1">#: The width of the central plateau in the initial profile [m]. For premixed</span>
    <span class="c1">#: flames, this mixture is composed of equilibrium products. For diffusion</span>
    <span class="c1">#: flames, this mixture is composed of a stoichiometric fuel/air brought to</span>
    <span class="c1">#: equilibrium at constant enthalpy and pressure.</span>
    <span class="n">centerWidth</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: The width of the slope away from the central plateau in the</span>
    <span class="c1">#: initial profile [m]. Recommended value for premixed flames:</span>
    <span class="c1">#: 5e-4. Recommended value for diffusion flames: 1e-3.</span>
    <span class="n">slopeWidth</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.0005</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Number of times to run the generated profile through a low pass</span>
    <span class="c1">#: filter before starting the simulation.</span>
    <span class="n">smoothCount</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: True if initial profiles for x,T,U,V and Y are given</span>
    <span class="n">haveProfiles</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Initial grid used if ``haveProfiles`` is set to ``True``</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Initial temperature profile used if ``haveProfiles`` is set to ``True``</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Initial tangential velocity gradient profile used if ``haveProfiles`` is</span>
    <span class="c1">#: set to ``True``</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Initial mass fraction profiles used if ``haveProfiles`` is set to</span>
    <span class="c1">#: ``True``</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Initial mass flux profile used if ``haveProfiles`` is set to ``True``</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div>



<div class="viewcode-block" id="WallFlux">
<a class="viewcode-back" href="../../input.html#ember.input.WallFlux">[docs]</a>
<span class="k">class</span> <span class="nc">WallFlux</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
    <span class="c1">#: Reference temperature for the wall heat flux</span>
    <span class="n">Tinf</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Conductance of the wall [W/m^2-K]</span>
    <span class="n">Kwall</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="Ignition">
<a class="viewcode-back" href="../../input.html#ember.input.Ignition">[docs]</a>
<span class="k">class</span> <span class="nc">Ignition</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters for an artificial heat release rate function which can</span>
<span class="sd">    be used to simulate ignition. The heat release rate is a step</span>
<span class="sd">    function in time with a Gaussian spatial distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: Beginning of the external heat release rate pulse [s].</span>
    <span class="n">tStart</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Duration of the external heat release rate pulse [s].</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Integral amplitude of the pulse [W/m^2].</span>
    <span class="n">energy</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Location of the center of the pulse [m].</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Characteristic width (standard deviation) of the pulse [m].</span>
    <span class="n">stddev</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<span class="k">class</span> <span class="nc">ExternalHeatFlux</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    User-specified function describing heat loss to the environment, e.g.</span>
<span class="sd">    through radiation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#: Heat loss function, which must be of the form `qdot = f(x, t, U, T, Y)`</span>
    <span class="c1">#: where `qdot` is the heat loss rate in W/m^3, `x` is the local position,</span>
    <span class="c1">#: `t` is the time, `U` is the tangential velocity gradient `T`  is the</span>
    <span class="c1">#: temperature and `Y` is the array of species mass fractions.</span>
    <span class="n">heatLoss</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Update the value of this function based on the current state vector of</span>
    <span class="c1">#: the source term integrator, rather than only at the start of each split</span>
    <span class="c1">#: timestep. Enabling this option incurs a significant performance penalty,</span>
    <span class="c1">#: and should only be done if the heat flux function is too stiff to be</span>
    <span class="c1">#: integrated otherwise.</span>
    <span class="n">alwaysUpdate</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>


<div class="viewcode-block" id="StrainParameters">
<a class="viewcode-back" href="../../input.html#ember.input.StrainParameters">[docs]</a>
<span class="k">class</span> <span class="nc">StrainParameters</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters defining the strain rate as a function of time.</span>

<span class="sd">    The strain rate changes linearly from *initial* to *final* over a</span>
<span class="sd">    period of *dt* seconds, starting at *tStart*.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">initial</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>  <span class="c1">#: Initial strain rate [1/s]</span>
    <span class="n">final</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>  <span class="c1">#: final strain rate [1/s]</span>
    <span class="n">tStart</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.000</span><span class="p">)</span>  <span class="c1">#: time at which strain rate starts to change [s]</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.002</span><span class="p">)</span>  <span class="c1">#: time period over which strain rate changes [s]</span>

    <span class="c1">#: A list of strain rates to use for a series of sequential</span>
    <span class="c1">#: integration periods (see :func:`~ember.utils.multirun`), with steady-state</span>
    <span class="c1">#: profiles generated for each strain rate before proceeding to the next.</span>
    <span class="c1">#: A typical list of strain rates to use::</span>
    <span class="c1">#:</span>
    <span class="c1">#:     rates = [9216, 7680, 6144, 4608, 3840, 3072, 2304, 1920, 1536,</span>
    <span class="c1">#:              1152, 960, 768, 576, 480, 384, 288, 240, 192, 144, 120,</span>
    <span class="c1">#:              96, 72, 60, 48, 36, 30, 24, 18, 15, 12]</span>
    <span class="n">rates</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Specify the strain rate as a function of time, using any callable</span>
    <span class="c1">#! Python object.</span>
    <span class="n">function</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<span class="k">class</span> <span class="nc">Extinction</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Settings pertaining to running a flame extinction simulation &quot;&quot;&quot;</span>

    <span class="c1">#: Choice of increasing strain rate by a multiplicative factor or step size</span>
    <span class="n">method</span> <span class="o">=</span> <span class="n">StringOption</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="s2">&quot;factor&quot;</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Starting and lower limits for increasing strain rate under either method</span>
    <span class="n">initialStep</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">25.0</span><span class="p">)</span>
    <span class="n">minStep</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">initialFactor</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1.05</span><span class="p">)</span>
    <span class="n">minFactor</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1.0001</span><span class="p">)</span>

    <span class="c1">#: Factor by which the strain rate step size or increase factor is reduced by after each non-burning solution</span>
    <span class="n">reductionFactor</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>

    <span class="c1">#: Maximum profile temperature below which simulation is considered non-burning and immediately ended</span>
    <span class="n">cutoffTemp</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">)</span>

    <span class="c1">#: Starting strain rate to be used when progressing to extinction</span>
    <span class="n">initialStrainRate</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">300.0</span><span class="p">)</span>


<div class="viewcode-block" id="PositionControl">
<a class="viewcode-back" href="../../input.html#ember.input.PositionControl">[docs]</a>
<span class="k">class</span> <span class="nc">PositionControl</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters defining the position of the flame as a function of</span>
<span class="sd">    time (for twin / curved flames).</span>

<span class="sd">    These parameters are used to adjust the mass flux at r = 0 to move</span>
<span class="sd">    the flame toward the desired location. The flame moves from</span>
<span class="sd">    *xInitial* to *xFinal* over *dt* seconds, starting at *tStart*.</span>

<span class="sd">    The feedback controller which determines the mass flux uses the</span>
<span class="sd">    distance between the current flame location and the desired flame</span>
<span class="sd">    location with the gains specified by *proportionalGain* and</span>
<span class="sd">    *integralGain*.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xInitial</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.0025</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isSymmetric</span><span class="p">)</span>  <span class="c1">#:</span>
    <span class="n">xFinal</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.0025</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isSymmetric</span><span class="p">)</span>  <span class="c1">#:</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isSymmetric</span><span class="p">)</span>  <span class="c1">#:</span>
    <span class="n">tStart</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isSymmetric</span><span class="p">)</span>  <span class="c1">#:</span>

    <span class="n">proportionalGain</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isSymmetric</span><span class="p">)</span>  <span class="c1">#:</span>
    <span class="n">integralGain</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_isSymmetric</span><span class="p">)</span>  <span class="c1">#:</span></div>



<div class="viewcode-block" id="Times">
<a class="viewcode-back" href="../../input.html#ember.input.Times">[docs]</a>
<span class="k">class</span> <span class="nc">Times</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Paremeters controlling integrator timesteps and frequency of</span>
<span class="sd">    output profiles.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: Integrator start time.</span>
    <span class="n">tStart</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Timestep used for operator splitting.</span>
    <span class="n">globalTimestep</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">2e-5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Control for timestep used by the diffusion integrator.</span>
    <span class="c1">#: Actual timestep will be this multiplier times the stability</span>
    <span class="c1">#: limit an explicit integrator.</span>
    <span class="n">diffusionTimestepMultiplier</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Maximum amount of time before regridding / adaptation.</span>
    <span class="n">regridTimeInterval</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Maximum number of timesteps before regridding / adaptation.</span>
    <span class="n">regridStepInterval</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Maximum number of steps between storing integral flame properties.</span>
    <span class="n">outputStepInterval</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Maximum time between storing integral flame properties.</span>
    <span class="n">outputTimeInterval</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Maximum number of timesteps before writing flame profiles.</span>
    <span class="n">profileStepInterval</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Maximum time between writing flame profiles.</span>
    <span class="n">profileTimeInterval</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Number of timesteps between writing profNow.h5</span>
    <span class="n">currentStateStepInterval</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Number of timesteps between checks of the steady-state</span>
    <span class="c1">#: termination conditions.</span>
    <span class="n">terminateStepInterval</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="CvodeTolerances">
<a class="viewcode-back" href="../../input.html#ember.input.CvodeTolerances">[docs]</a>
<span class="k">class</span> <span class="nc">CvodeTolerances</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Tolerances for the CVODE chemistry integrator &quot;&quot;&quot;</span>

    <span class="c1">#: Relative tolerance for each state variable</span>
    <span class="n">relativeTolerance</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingCvode</span><span class="p">)</span>

    <span class="c1">#: Absolute tolerance for U velocity</span>
    <span class="n">momentumAbsTol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingCvode</span><span class="p">)</span>

    <span class="c1">#: Absolute tolerance for T</span>
    <span class="n">energyAbsTol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingCvode</span><span class="p">)</span>

    <span class="c1">#: Absolute tolerance for species mass fractions.</span>
    <span class="n">speciesAbsTol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-13</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingCvode</span><span class="p">)</span>

    <span class="c1">#: Minimum internal timestep</span>
    <span class="n">minimumTimestep</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-18</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingCvode</span><span class="p">)</span></div>



<div class="viewcode-block" id="QssTolerances">
<a class="viewcode-back" href="../../input.html#ember.input.QssTolerances">[docs]</a>
<span class="k">class</span> <span class="nc">QssTolerances</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Tolerances for the QSS chemistry integrator &quot;&quot;&quot;</span>

    <span class="c1">#: Accuracy parameter for determining the next timestep.</span>
    <span class="n">epsmin</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingQss</span><span class="p">)</span>

    <span class="c1">#: Accuracy parameter for repeating timesteps</span>
    <span class="n">epsmax</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingQss</span><span class="p">)</span>

    <span class="c1">#: Minimum internal timestep</span>
    <span class="n">dtmin</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-16</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingQss</span><span class="p">)</span>

    <span class="c1">#: Maximum internal timestep</span>
    <span class="n">dtmax</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingQss</span><span class="p">)</span>

    <span class="c1">#: Number of corrector iterations per timestep.</span>
    <span class="n">iterationCount</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingQss</span><span class="p">)</span>

    <span class="c1">#: Absolute threshold for including each component in the accuracy</span>
    <span class="c1">#: tests.</span>
    <span class="n">abstol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-11</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingQss</span><span class="p">)</span>

    <span class="c1">#: Lower limit on the value of each state vector component.</span>
    <span class="n">minval</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-60</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingQss</span><span class="p">)</span>

    <span class="c1">#: Enable convergence-based stability check on timestep. Not</span>
    <span class="c1">#: enabled unless *iterationCount* &gt;= 3.</span>
    <span class="n">stabilityCheck</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">_usingQss</span><span class="p">)</span></div>



<div class="viewcode-block" id="Debug">
<a class="viewcode-back" href="../../input.html#ember.input.Debug">[docs]</a>
<span class="k">class</span> <span class="nc">Debug</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Control of verbose debugging output &quot;&quot;&quot;</span>

    <span class="c1">#: Addition / removal of internal grid points.</span>
    <span class="n">adaptation</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Addition / removal of boundary grid points.</span>
    <span class="n">regridding</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Print current time after each global timestep.</span>
    <span class="n">timesteps</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Enable extensive timestep debugging output. Automatically</span>
    <span class="c1">#: enabled for debug builds.</span>
    <span class="n">veryVerbose</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Print information about the flame radius feedback controller.</span>
    <span class="n">flameRadiusControl</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Grid point to print debugging information about at *sourceTime*.</span>
    <span class="n">sourcePoint</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Time at which to print extensive debugging information about</span>
    <span class="c1">#: the source term at j = *sourcePoint*, then terminate.</span>
    <span class="n">sourceTime</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Time at which to start saving intermediate integrator profiles when</span>
    <span class="c1">#: OutputFiles.debugIntegratorStages is True</span>
    <span class="n">startTime</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1">#: Time at which to stop saving intermediate integrator profiles when</span>
    <span class="c1">#: OutputFiles.debugIntegratorStages is True</span>
    <span class="n">stopTime</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div>


<div class="viewcode-block" id="OutputFiles">
<a class="viewcode-back" href="../../input.html#ember.input.OutputFiles">[docs]</a>
<span class="k">class</span> <span class="nc">OutputFiles</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Control the contents of the periodic output files &quot;&quot;&quot;</span>
    <span class="c1">#: File extension of the output files. &#39;h5&#39; for HDF5 files, which require</span>
    <span class="c1">#: the &#39;h5py&#39; Python module and can be read by other programs, or &#39;npz&#39; for</span>
    <span class="c1">#: a compressed NumPy data structure.</span>
    <span class="n">fileExtension</span> <span class="o">=</span> <span class="n">dynamicDefaultFileExtension</span>

    <span class="c1">#: Include the heat release rate as a function of space</span>
    <span class="n">heatReleaseRate</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Include the reaction / diffusion / convection contributions to</span>
    <span class="c1">#: the net time derivative of each state variable</span>
    <span class="n">timeDerivatives</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Include variables such as transport properties and grid</span>
    <span class="c1">#: parameters that can be recomputed from the state variables.</span>
    <span class="n">extraVariables</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Include other miscellaneous variables</span>
    <span class="n">auxiliaryVariables</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Used to generate a continuous sequence of output files after</span>
    <span class="c1">#: restarting the code.</span>
    <span class="n">firstFileNumber</span> <span class="o">=</span> <span class="n">IntegerOption</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Generate ``profNNNNNN.h5`` files</span>
    <span class="n">saveProfiles</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#: Write profiles after each stage of the split integrator.</span>
    <span class="n">debugIntegratorStages</span> <span class="o">=</span> <span class="n">BoolOption</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Class used to write periodic output files (e.g. profNNNNNN.h5)</span>
    <span class="n">stateWriter</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">StateWriter</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#: Class used to write time-series files (e.g. out.h5)</span>
    <span class="n">timeSeriesWriter</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">TimeSeriesWriter</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="TerminationCondition">
<a class="viewcode-back" href="../../input.html#ember.input.TerminationCondition">[docs]</a>
<span class="k">class</span> <span class="nc">TerminationCondition</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integrate until either *tEnd* is reached or a criterion based on</span>
<span class="sd">    *measurement* is satisfied. The *measurement*-based check is not enabled</span>
<span class="sd">    until *tMin* is reached.</span>

<span class="sd">    - If `measurement == None`, integration will proceed to *tEnd*.</span>

<span class="sd">    - If `measurement == &#39;Q&#39;`, integration will terminate when the the heat</span>
<span class="sd">      release rate reaches a steady-state value to within *tolerance* (RMS)</span>
<span class="sd">      over a time period of *steadyPeriod*, or the mean heat release rate over</span>
<span class="sd">      *steadyPeriod* is less than *abstol*.</span>

<span class="sd">    - If `measurement == &#39;dTdt&#39;`, integration will terminate when</span>
<span class="sd">      `||1/T * dT/dt|| / sqrt(nPoints)`  is less than *dTdtTol*.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tEnd</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>  <span class="c1">#:</span>

    <span class="n">measurement</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;dTdt&#39;</span><span class="p">))</span>  <span class="c1">#:</span>
    <span class="n">tolerance</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">#:</span>
    <span class="n">abstol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">#:</span>
    <span class="n">steadyPeriod</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.002</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#:</span>
    <span class="n">tMin</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#:</span>
    <span class="n">dTdtTol</span> <span class="o">=</span> <span class="n">FloatOption</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span> <span class="c1">#:</span></div>



<div class="viewcode-block" id="Config">
<a class="viewcode-back" href="../../input.html#ember.input.Config">[docs]</a>
<span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An object consisting of a set of Options objects which define a</span>
<span class="sd">    complete set of configuration options needed to run the flame</span>
<span class="sd">    solver.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Options</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> is not an instance of class Options&#39;</span> <span class="o">%</span> <span class="n">arg</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Multiple instances of class </span><span class="si">%r</span><span class="s1"> encountered&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">opts</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span>

        <span class="n">get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">cls</span><span class="p">:</span> <span class="n">opts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">cls</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">paths</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">Paths</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">General</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chemistry</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">Chemistry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">Grid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">InitialCondition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wallFlux</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;WallFlux&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignition</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">Ignition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">externalHeatFlux</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">ExternalHeatFlux</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">StrainParameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positionControl</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PositionControl&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">Times</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cvodeTolerances</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">CvodeTolerances</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qssTolerances</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">QssTolerances</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputFiles</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">OutputFiles</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminationCondition</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">TerminationCondition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">Extinction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ConcreteConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Options</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">item</span>

    <span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">_stringify</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
                <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;conf = Config(</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cylindricalFlame</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">flameGeometry</span> <span class="o">==</span> <span class="s1">&#39;cylindrical&#39;</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="n">discFlame</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">flameGeometry</span> <span class="o">==</span> <span class="s1">&#39;disc&#39;</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="c1"># Position control can only be used with &quot;twin&quot; or &quot;curved&quot; flames</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positionControl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">twinFlame</span> <span class="ow">and</span>
            <span class="ow">not</span> <span class="n">cylindricalFlame</span><span class="p">):</span>
            <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: PositionControl can only be used when either &#39;twinFlame&#39;</span><span class="se">\n</span><span class="s2">&quot;</span>
                  <span class="s2">&quot;       or &#39;cylindricalFlame&#39; is set to True.&quot;</span><span class="p">)</span>

        <span class="c1"># twinFlame and cylindricalFlame are mutually exclusive:</span>
        <span class="k">if</span> <span class="n">cylindricalFlame</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">twinFlame</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: &#39;twinFlame&#39; and &#39;cylindricalFlame&#39; are mutually exclusive.&quot;</span><span class="p">)</span>

        <span class="c1"># discFlame and cylindricalFlame are mutually exclusive:</span>
        <span class="k">if</span> <span class="n">cylindricalFlame</span> <span class="ow">and</span> <span class="n">discFlame</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: &#39;discFlame&#39; and &#39;cylindricalFlame&#39; are mutually exclusive.&quot;</span><span class="p">)</span>

        <span class="c1"># the &quot;fuelLeft&quot; option only makes sense for diffusion flames</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;premixed&#39;</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fuelLeft</span><span class="o">.</span><span class="n">isSet</span><span class="p">):</span>
            <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: &#39;general.fuelLeft&#39; should not be specified for premixed flames.&quot;</span><span class="p">)</span>

        <span class="c1"># the &quot;unburnedLeft&quot; option only makes sense for premixed flames</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;diffusion&#39;</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">unburnedLeft</span><span class="o">.</span><span class="n">isSet</span><span class="p">):</span>
            <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: &#39;general.unburnedLeft&#39; should not be specified for diffusion flames.&quot;</span><span class="p">)</span>

        <span class="c1"># the &quot;fixedTemperature&quot; boundary condition currently only works with</span>
        <span class="c1"># balanced splitting</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">splittingMethod</span> <span class="o">==</span> <span class="s1">&#39;strang&#39;</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">continuityBC</span> <span class="o">==</span> <span class="s1">&#39;fixedTemperature&#39;</span><span class="p">):</span>
            <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: &#39;fixedTemperature&#39; continuity boundary condition is&quot;</span>
                  <span class="s2">&quot; only compatible with &#39;balanced&#39; splitting.&quot;</span><span class="p">)</span>

        <span class="c1"># Make sure that the mechanism file actually works and contains the</span>
        <span class="c1"># specified fuel and oxidizer species</span>
        <span class="n">gas</span> <span class="o">=</span> <span class="n">cantera</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chemistry</span><span class="o">.</span><span class="n">mechanismFile</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">chemistry</span><span class="o">.</span><span class="n">phaseID</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                               <span class="n">transport_model</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">fuel</span><span class="o">.</span><span class="n">value</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">oxidizer</span><span class="o">.</span><span class="n">value</span>

        <span class="c1"># Make sure that the mechanism file has sane rate coefficients</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;premixed&#39;</span><span class="p">:</span>
            <span class="n">Tcheck</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">Tu</span><span class="o">.</span><span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Tcheck</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">Tfuel</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">Toxidizer</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">error</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkRateConstants</span><span class="p">(</span><span class="n">gas</span><span class="p">,</span> <span class="n">Tcheck</span><span class="p">)</span>

        <span class="c1"># Make sure the restart file is in the correct place (if specified)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">restartFile</span><span class="p">:</span>
            <span class="n">restart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">restartFile</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">restart</span><span class="p">):</span>
                <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Couldn&#39;t find restart file </span><span class="si">%r</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">restart</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Validation failed.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;To force simulation attempt: Config.run(&quot;force&quot;)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Validation completed successfully.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="ow">not</span> <span class="n">error</span>

<div class="viewcode-block" id="Config.checkRateConstants">
<a class="viewcode-back" href="../../input.html#ember.input.Config.checkRateConstants">[docs]</a>
    <span class="k">def</span> <span class="nf">checkRateConstants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gas</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function for finding reactions with suspiciously high</span>
<span class="sd">        rate constants at low temperatures.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gas</span><span class="o">.</span><span class="n">TPY</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span> <span class="mi">101325</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">n_species</span><span class="p">)</span>
        <span class="n">Rf</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">forward_rate_constants</span>
        <span class="n">Rr</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">reverse_rate_constants</span>
        <span class="n">error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Rf</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">Rf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e30</span><span class="p">:</span>
                <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: Excessively high forward rate constant&#39;</span>
                      <span class="s1">&#39; for reaction </span><span class="si">%i</span><span class="s1"> at T = </span><span class="si">%6.2f</span><span class="s1"> K&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    Reaction equation: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">gas</span><span class="o">.</span><span class="n">reaction_equation</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    Forward rate constant: </span><span class="si">%e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">Rf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">Rr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e30</span><span class="p">:</span>
                <span class="n">error</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: Excessively high reverse rate constant&#39;</span>
                      <span class="s1">&#39; for reaction </span><span class="si">%i</span><span class="s1"> at T = </span><span class="si">%6.2f</span><span class="s1"> K&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    Reaction equation: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">gas</span><span class="o">.</span><span class="n">reaction_equation</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    Reverse rate constant: </span><span class="si">%e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">Rr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">error</span></div>


<div class="viewcode-block" id="Config.run">
<a class="viewcode-back" href="../../run-sim.html#ember.input.Config.run">[docs]</a>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run the simulation using the parameters set in this Config.</span>

<span class="sd">        If a list strain rates is provided by the field</span>
<span class="sd">        :attr:`strainParameters.rates`, a sequence of flame simulations at the</span>
<span class="sd">        given strain rates will be run. Otherwise, a single simulation will be</span>
<span class="sd">        run.</span>

<span class="sd">        If the script which calls this function is passed the argument</span>
<span class="sd">        *validate*, then the configuration will be checked for errors and the</span>
<span class="sd">        script will exit without running the simulation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;validate&#39;</span><span class="p">:</span>
            <span class="c1"># Validate the configuration and exit</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">command</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s1">&#39;validate&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">!=</span> <span class="s1">&#39;force&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;An argument of &quot;force&quot; will allow for skipping validation and attempting to simulate.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exiting...&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">concrete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">rates</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">concrete</span><span class="o">.</span><span class="n">multirun</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">concrete</span><span class="o">.</span><span class="n">run</span><span class="p">()</span></div>



<div class="viewcode-block" id="Config.runESR">
<a class="viewcode-back" href="../../input.html#ember.input.Config.runESR">[docs]</a>
    <span class="k">def</span> <span class="nf">runESR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run an extinction strain rate simulation using the parameters set in</span>
<span class="sd">        this Config.</span>

<span class="sd">        The strain rate parameter will be increased until a steady burning flame</span>
<span class="sd">        can no longer be achieved.</span>

<span class="sd">        If the script which calls this function is passed the argument</span>
<span class="sd">        *validate*, then the configuration will be checked for errors and the</span>
<span class="sd">        script will exit without running the simulation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;validate&#39;</span><span class="p">:</span>
            <span class="c1"># Validate the configuration and exit</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">concrete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">command</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s1">&#39;validate&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">!=</span> <span class="s1">&#39;force&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;An argument of &quot;force&quot; will allow for skipping validation and attempting to simulate.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exiting...&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">return</span> <span class="n">concrete</span><span class="o">.</span><span class="n">runESR</span><span class="p">()</span></div>
</div>




<span class="k">class</span> <span class="nc">ConcreteConfig</span><span class="p">(</span><span class="n">_ember</span><span class="o">.</span><span class="n">ConfigOptions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Same structure as class Config, but all the Option objects are replaced</span>
<span class="sd">    with their actual values, and these values are propagated to an underlying</span>
<span class="sd">    C++ object as necessary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ConcreteConfig</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original</span> <span class="o">=</span> <span class="n">config</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">opts</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="n">Options</span><span class="p">):</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
                <span class="n">group</span><span class="o">.</span><span class="n">original</span> <span class="o">=</span> <span class="n">opts</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">opts</span><span class="p">):</span>
                    <span class="n">opt</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">opt</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">opts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gas</span> <span class="o">=</span> <span class="n">cantera</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chemistry</span><span class="o">.</span><span class="n">mechanismFile</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">chemistry</span><span class="o">.</span><span class="n">phaseID</span><span class="p">,</span>
                                    <span class="n">transport_model</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fixedBurnedVal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">twinFlame</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">flameGeometry</span> <span class="o">==</span> <span class="s1">&#39;cylindrical&#39;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">unburnedLeft</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fixedBurnedVal</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fixedBurnedVal</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;quasi2d&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setupQuasi2d</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">restartFile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">readInitialCondition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">restartFile</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span><span class="o">.</span><span class="n">haveProfiles</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generateInitialCondition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_options</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">readInitialCondition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restartFile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read the initial profiles for temperature, species mass fractions, and</span>
<span class="sd">        velocity from the specified input file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">HDFStruct</span><span class="p">(</span><span class="n">restartFile</span><span class="p">)</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">x</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Y</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">U</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">V</span>

        <span class="n">IC</span><span class="o">.</span><span class="n">haveProfiles</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">isSet</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;fuel&#39;</span><span class="p">,</span> <span class="s1">&#39;oxidizer&#39;</span><span class="p">,</span> <span class="s1">&#39;Tfuel&#39;</span><span class="p">,</span> <span class="s1">&#39;Toxidizer&#39;</span><span class="p">,</span> <span class="s1">&#39;reactants&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;equivalenceRatio&#39;</span><span class="p">,</span> <span class="s1">&#39;Tcounterflow&#39;</span><span class="p">,</span> <span class="s1">&#39;counterflow&#39;</span><span class="p">))):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setBoundaryValues</span><span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">V</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setBoundaryValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">IC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span>
        <span class="n">jm</span> <span class="o">=</span> <span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">nPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas</span>

        <span class="k">if</span> <span class="n">IC</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;premixed&#39;</span><span class="p">:</span>
            <span class="c1"># Reactants</span>
            <span class="k">if</span> <span class="n">IC</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
                <span class="n">gas</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">reactants</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gas</span><span class="o">.</span><span class="n">set_equivalence_ratio</span><span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">equivalenceRatio</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">fuel</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">oxidizer</span><span class="p">)</span>

            <span class="n">gas</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tu</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">pressure</span>
            <span class="n">rhou</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">density</span>
            <span class="n">Yu</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">Y</span>

            <span class="c1"># Products</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">equilibrate</span><span class="p">(</span><span class="s1">&#39;HP&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tcounterflow</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">Tb</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">T</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Tb</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tcounterflow</span>
            <span class="k">if</span> <span class="n">IC</span><span class="o">.</span><span class="n">counterflow</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">Yb</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">Y</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">counterflow</span>
                <span class="n">Yb</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">Y</span>

            <span class="k">if</span> <span class="n">IC</span><span class="o">.</span><span class="n">equilibrateCounterflow</span><span class="p">:</span>
                <span class="n">gas</span><span class="o">.</span><span class="n">TPY</span> <span class="o">=</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="n">Yb</span>
                <span class="n">gas</span><span class="o">.</span><span class="n">equilibrate</span><span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">equilibrateCounterflow</span><span class="p">)</span>
                <span class="n">Yb</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">Y</span>
                <span class="n">Tb</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">T</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">unburnedLeft</span><span class="p">:</span>
                <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tu</span>
                <span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Yu</span>
                <span class="k">if</span> <span class="n">V</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">V</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tb</span>
                    <span class="n">Y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Yb</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">V</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tb</span>
                    <span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Yb</span>
                <span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tu</span>
                <span class="n">Y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Yu</span>

        <span class="k">elif</span> <span class="n">IC</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;diffusion&#39;</span><span class="p">:</span>
            <span class="c1"># Fuel</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tfuel</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">fuel</span>
            <span class="n">Yfuel</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">Y</span>

            <span class="c1"># Oxidizer</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Toxidizer</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">oxidizer</span>
            <span class="k">if</span> <span class="n">IC</span><span class="o">.</span><span class="n">equilibrateCounterflow</span><span class="p">:</span>
                <span class="n">gas</span><span class="o">.</span><span class="n">equilibrate</span><span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">equilibrateCounterflow</span><span class="p">)</span>
            <span class="n">rhou</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">density</span>  <span class="c1"># use oxidizer value for diffusion flame</span>

            <span class="n">Yoxidizer</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">Y</span>
            <span class="n">Toxidizer</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">T</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fuelLeft</span><span class="p">:</span>
                <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tfuel</span>
                <span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Yfuel</span>
                <span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Toxidizer</span>
                <span class="n">Y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Yoxidizer</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Toxidizer</span>
                <span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Yoxidizer</span>
                <span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tfuel</span>
                <span class="n">Y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Yfuel</span>

        <span class="k">return</span> <span class="n">rhou</span>

    <span class="k">def</span> <span class="nf">generateInitialCondition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate initial profiles for temperature, species mass fractions, and</span>
<span class="sd">        velocity using the specified fuel and oxidizer compositions and flame</span>
<span class="sd">        configuration parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">flameGeometry</span><span class="o">==</span><span class="s1">&#39;disc&#39;</span> <span class="k">else</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">nPoints</span>
        <span class="n">gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas</span>

        <span class="n">xLeft</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">twinFlame</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">flameGeometry</span> <span class="o">==</span> <span class="s1">&#39;cylindrical&#39;</span>
                 <span class="k">else</span> <span class="n">IC</span><span class="o">.</span><span class="n">xLeft</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xLeft</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">xRight</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">n_species</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="n">jm</span> <span class="o">=</span> <span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">nPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>

        <span class="c1"># make sure the initial profile fits comfortably in the domain</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">centerWidth</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">IC</span><span class="o">.</span><span class="n">slopeWidth</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">IC</span><span class="o">.</span><span class="n">slopeWidth</span> <span class="o">*=</span> <span class="n">scale</span>
            <span class="n">IC</span><span class="o">.</span><span class="n">centerWidth</span> <span class="o">*=</span> <span class="n">scale</span>

        <span class="c1"># Determine the grid indices defining each profile segment</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">centerPointCount</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">IC</span><span class="o">.</span><span class="n">centerWidth</span> <span class="o">/</span> <span class="n">dx</span><span class="p">)</span>
        <span class="n">slopePointCount</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">IC</span><span class="o">.</span><span class="n">slopeWidth</span> <span class="o">/</span> <span class="n">dx</span><span class="p">)</span>
        <span class="n">jl2</span> <span class="o">=</span> <span class="n">jm</span> <span class="o">-</span> <span class="n">centerPointCount</span>
        <span class="n">jl1</span> <span class="o">=</span> <span class="n">jl2</span> <span class="o">-</span> <span class="n">slopePointCount</span>
        <span class="n">jr1</span> <span class="o">=</span> <span class="n">jm</span> <span class="o">+</span> <span class="n">centerPointCount</span>
        <span class="n">jr2</span> <span class="o">=</span> <span class="n">jr1</span> <span class="o">+</span> <span class="n">slopePointCount</span>

        <span class="n">rhou</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setBoundaryValues</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">IC</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;premixed&#39;</span><span class="p">:</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">set_equivalence_ratio</span><span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">equivalenceRatio</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">fuel</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">oxidizer</span><span class="p">)</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">IC</span><span class="o">.</span><span class="n">Tu</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">pressure</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">equilibrate</span><span class="p">(</span><span class="s1">&#39;HP&#39;</span><span class="p">)</span>
            <span class="n">T</span><span class="p">[</span><span class="n">jm</span><span class="p">]</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">T</span>
            <span class="n">Y</span><span class="p">[:,</span><span class="n">jm</span><span class="p">]</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">Y</span>

        <span class="k">elif</span> <span class="n">IC</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;diffusion&#39;</span><span class="p">:</span>
            <span class="c1"># Assume stoichiometric mixture at the center</span>
            <span class="n">IC</span><span class="o">.</span><span class="n">equivalenceRatio</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">set_equivalence_ratio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">fuel</span><span class="p">,</span> <span class="n">IC</span><span class="o">.</span><span class="n">oxidizer</span><span class="p">)</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">Tfuel</span><span class="o">+</span><span class="n">IC</span><span class="o">.</span><span class="n">Toxidizer</span><span class="p">),</span> <span class="n">IC</span><span class="o">.</span><span class="n">pressure</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">equilibrate</span><span class="p">(</span><span class="s1">&#39;HP&#39;</span><span class="p">)</span>
            <span class="n">T</span><span class="p">[</span><span class="n">jm</span><span class="p">]</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">T</span>
            <span class="n">Y</span><span class="p">[:,</span><span class="n">jm</span><span class="p">]</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">Y</span>

        <span class="n">newaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span>
        <span class="n">Y</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="n">jl1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">jl1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">ramp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jl2</span><span class="o">-</span><span class="n">jl1</span><span class="p">)</span>
        <span class="n">Y</span><span class="p">[:,</span><span class="n">jl1</span><span class="p">:</span><span class="n">jl2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span><span class="p">[:,</span><span class="n">jm</span><span class="p">]</span><span class="o">-</span><span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])[:,</span><span class="n">newaxis</span><span class="p">]</span><span class="o">*</span><span class="n">ramp</span>
        <span class="n">T</span><span class="p">[</span><span class="n">jl1</span><span class="p">:</span><span class="n">jl2</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">jm</span><span class="p">]</span><span class="o">-</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">ramp</span>

        <span class="n">Y</span><span class="p">[:,</span><span class="n">jl2</span><span class="p">:</span><span class="n">jr1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:,</span><span class="n">jm</span><span class="p">,</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">T</span><span class="p">[</span><span class="n">jl2</span><span class="p">:</span><span class="n">jr1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">jm</span><span class="p">]</span>

        <span class="n">ramp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jr2</span><span class="o">-</span><span class="n">jr1</span><span class="p">)</span>
        <span class="n">Y</span><span class="p">[:,</span><span class="n">jr1</span><span class="p">:</span><span class="n">jr2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:,</span><span class="n">jm</span><span class="p">,</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Y</span><span class="p">[:,</span><span class="n">jm</span><span class="p">])[:,</span><span class="n">newaxis</span><span class="p">]</span><span class="o">*</span><span class="n">ramp</span>
        <span class="n">T</span><span class="p">[</span><span class="n">jr1</span><span class="p">:</span><span class="n">jr2</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">jm</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">T</span><span class="p">[</span><span class="n">jm</span><span class="p">])</span> <span class="o">*</span> <span class="n">ramp</span>

        <span class="n">Y</span><span class="p">[:,</span><span class="n">jr2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">T</span><span class="p">[</span><span class="n">jr2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">YT</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">T</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">IC</span><span class="o">.</span><span class="n">smoothCount</span><span class="p">):</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">YT</span><span class="p">)</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">YT</span><span class="o">.</span><span class="n">T</span>

        <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">function</span><span class="p">:</span>
            <span class="n">a0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">tStart</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">initial</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">gas</span><span class="o">.</span><span class="n">TPY</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">IC</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="n">Y</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span>
            <span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">density</span>
            <span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">/</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rhou</span><span class="o">/</span><span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">twinFlame</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">flameGeometry</span> <span class="o">==</span> <span class="s1">&#39;cylindrical&#39;</span><span class="p">:</span>
            <span class="c1"># Stagnation point at x = 0</span>
            <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
                <span class="c1"># derived from finite difference of continuity equation</span>
                <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">IC</span><span class="o">.</span><span class="n">flameType</span> <span class="o">==</span> <span class="s1">&#39;diffusion&#39;</span><span class="p">:</span>
            <span class="n">jz</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="mi">4</span> <span class="c1"># place stagnation point on the fuel side (flame on oxidizer side)</span>
            <span class="n">V</span><span class="p">[</span><span class="n">jz</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jz</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
                <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jz</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span> <span class="c1"># Single Premixed jet opposing inert or hot products</span>
            <span class="n">jz</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">N</span> <span class="o">//</span> <span class="mi">4</span>  <span class="c1"># place stagnation point on the products/inert side</span>
            <span class="n">V</span><span class="p">[</span><span class="n">jz</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jz</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
                <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jz</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="n">IC</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">U</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">haveProfiles</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">setupQuasi2d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">IC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialCondition</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">HDFStruct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">interpFile</span><span class="p">)</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">r</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Y0</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">U</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">vz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">haveProfiles</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">IC</span><span class="o">.</span><span class="n">interpData</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a single flame simulation using the parameters set in this Config.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">confString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original</span><span class="o">.</span><span class="n">stringify</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span> <span class="mo">0o0755</span><span class="p">)</span>
        <span class="n">confOutPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">confOutPath</span><span class="p">)):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">confOutPath</span><span class="p">)</span>
        <span class="n">confOut</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">confOutPath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">confOut</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">confString</span><span class="p">)</span>

        <span class="n">solver</span> <span class="o">=</span> <span class="n">_ember</span><span class="o">.</span><span class="n">FlameSolver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">solver</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
        <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">done</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">solver</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">solver</span>

    <span class="k">def</span> <span class="nf">runESR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a sequence of flame simulations at increasing strain rates until</span>
<span class="sd">        a steady burning solution is no longer possible with an increase</span>
<span class="sd">        in strain rate. The parameters governing this progression are defined</span>
<span class="sd">        under the configuration field :attr:`Extinction`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Output directory already exists&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exiting...&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Establishing the directory structure for saving the output files from</span>
        <span class="c1"># the number of flame simulations at increasing strain rates</span>
        <span class="n">outDirTop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span>
        <span class="n">logPath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="o">+</span><span class="s1">&#39;/logFiles&#39;</span>
        <span class="n">currentRunPath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="o">+</span><span class="s1">&#39;/runFiles&#39;</span>
        <span class="n">ssProfilePath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="o">+</span><span class="s1">&#39;/ssFiles&#39;</span>
        <span class="n">restartPath</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span> <span class="o">=</span> <span class="n">currentRunPath</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">outDirTop</span><span class="p">,</span> <span class="mo">0o0755</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">logPath</span><span class="p">,</span> <span class="mo">0o0755</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">currentRunPath</span><span class="p">,</span> <span class="mo">0o0755</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">ssProfilePath</span><span class="p">,</span> <span class="mo">0o0755</span><span class="p">)</span>

        <span class="n">fileExt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputFiles</span><span class="o">.</span><span class="n">fileExtension</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">logFile</span><span class="p">:</span>
            <span class="n">_logFile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">logFile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
                <span class="n">_logFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="n">_logFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">_logFile</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="n">strainRateValues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">maxTemps</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">strainRate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">initialStrainRate</span>

        <span class="c1"># There are two methods that can be used to progress and converge to the</span>
        <span class="c1"># extinction strain rate. The first is by an initially constant step</span>
        <span class="c1"># size in strain rate that will later be reduced when converging to the</span>
        <span class="c1"># extinction point. The second is to increase by a factor of the current</span>
        <span class="c1"># strain rate which will also be reduced when converging to the</span>
        <span class="c1"># extinction point.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
            <span class="n">stepSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">initialStep</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">incFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">initialFactor</span>

        <span class="n">complete</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">hasExtinguished</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># The extinction simulation is considered converged once the step size</span>
        <span class="c1"># or increase factor has been reduced below the minimum cutoff value</span>
        <span class="c1"># that is specified by the user in the configuration script.</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">complete</span><span class="p">:</span>
            <span class="c1"># Because a continuation approach is used, the flame solution at the</span>
            <span class="c1"># previous strain rate is used as an initial guess for the flame at</span>
            <span class="c1"># the new strain rate, and &#39;restartPath&#39; references the location of</span>
            <span class="c1"># the most recently converged strained flame at the highest strain</span>
            <span class="c1"># rate so far.</span>
            <span class="k">if</span> <span class="n">restartPath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
                    <span class="n">strainRate</span> <span class="o">+=</span> <span class="n">stepSize</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">strainRate</span> <span class="o">*=</span> <span class="n">incFactor</span>

            <span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Beginning run at strain rate:  </span><span class="si">%g</span><span class="s1"> s^-1&#39;</span> <span class="o">%</span> <span class="n">strainRate</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">initial</span> <span class="o">=</span> <span class="n">strainRate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">final</span> <span class="o">=</span> <span class="n">strainRate</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">logFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">logPath</span><span class="p">,</span> <span class="s1">&#39;log_sr</span><span class="si">{:08.2f}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strainRate</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_options</span><span class="p">()</span>
            <span class="n">solver</span> <span class="o">=</span> <span class="n">_ember</span><span class="o">.</span><span class="n">FlameSolver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">solver</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

            <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">extinguished</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">done</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                <span class="c1"># In order to speed up ESR calculations, the user specifies in</span>
                <span class="c1"># the input a &#39;cutoffTemp&#39;. If the simulation maximum</span>
                <span class="c1"># temperature falls below this temperature, the simulation</span>
                <span class="c1"># stops, and it is assumed that the simulation would simply</span>
                <span class="c1"># continue in time until converging to a non-burning opposed jet</span>
                <span class="c1"># solution which can be computationally intensive, especially</span>
                <span class="c1"># for kinetic models with large numbers of species.</span>
                <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">cutoffTemp</span><span class="p">:</span>
                    <span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">extinguished</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">solver</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Run finished; Integration took </span><span class="si">%.1f</span><span class="s1"> seconds.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t2</span><span class="o">-</span><span class="n">t1</span><span class="p">))</span>

            <span class="c1"># When using &#39;dTdt&#39; strained flame convergence near the extinction</span>
            <span class="c1"># strain rate, under some conditions the simulation will converge</span>
            <span class="c1"># prematurely. This will yield a maximum temperature that is</span>
            <span class="c1"># incorrectly greater than the previous max T at a lower strain</span>
            <span class="c1"># rate. When this issue is observed, the following code block</span>
            <span class="c1"># modifies and tightens the convergence criteria accordingly to</span>
            <span class="c1"># avoid this non-physical result.</span>
            <span class="k">if</span> <span class="n">hasExtinguished</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">maxTemps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminationCondition</span><span class="o">.</span><span class="n">measurement</span> <span class="o">==</span> <span class="s1">&#39;dTdt&#39;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Switching convergence method to Q&#39;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">terminationCondition</span><span class="o">.</span><span class="n">measurement</span> <span class="o">=</span> <span class="s1">&#39;Q&#39;</span>

                        <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
                            <span class="n">done</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">cutoffTemp</span><span class="p">:</span>
                                <span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="n">extinguished</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">solver</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
                        <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                    <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">maxTemps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tightening tolerance&#39;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">terminationCondition</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">/=</span> <span class="mf">2.0</span>

                        <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
                            <span class="n">done</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">cutoffTemp</span><span class="p">:</span>
                                <span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="n">extinguished</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">solver</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
                        <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                    <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">maxTemps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Refining tolerance failed&#39;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;marking as extinguished..&#39;</span><span class="p">)</span>
                        <span class="n">extinguished</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># When a steady, burning solution is found, the solution is saved</span>
            <span class="c1"># and the starting point for subsequent simulations is updated to</span>
            <span class="c1"># this newly converged strain rate.</span>
            <span class="k">if</span> <span class="n">extinguished</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Found burning solution with Tmax = </span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">max</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>

                <span class="n">restartFile</span> <span class="o">=</span> <span class="s1">&#39;prof_sr</span><span class="si">{:08.2f}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strainRate</span><span class="p">,</span> <span class="n">fileExt</span><span class="p">)</span>
                <span class="n">restartPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ssProfilePath</span><span class="p">,</span> <span class="n">restartFile</span><span class="p">)</span>

                <span class="n">solver</span><span class="o">.</span><span class="n">writeStateFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">restartFile</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span> <span class="n">restartFile</span><span class="p">),</span> <span class="n">restartPath</span><span class="p">)</span>

                <span class="n">strainRateValues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strainRate</span><span class="p">)</span>
                <span class="n">maxTemps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outDirTop</span><span class="p">,</span> <span class="s1">&#39;conf_extinction.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">confOut</span><span class="p">:</span>
                    <span class="n">confOut</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original</span><span class="o">.</span><span class="n">stringify</span><span class="p">())</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Found non-burning solution&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">restartPath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">hasExtinguished</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
                        <span class="n">strainRate</span> <span class="o">-=</span> <span class="n">stepSize</span>
                        <span class="n">stepSize</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">reductionFactor</span>
                        <span class="k">if</span> <span class="n">stepSize</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">minStep</span><span class="p">:</span>
                            <span class="n">complete</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">strainRate</span> <span class="o">/=</span> <span class="n">incFactor</span>
                        <span class="n">incFactor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">incFactor</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">reductionFactor</span>
                        <span class="k">if</span> <span class="n">incFactor</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">extinction</span><span class="o">.</span><span class="n">minFactor</span><span class="p">:</span>
                            <span class="n">complete</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># To reduce the number of files produced during an extinction</span>
            <span class="c1"># simulation, the intermediate time point solutions are deleted</span>
            <span class="c1"># after completing a run to the steady state solution.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">complete</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">currentRunPath</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">currentRunPath</span><span class="p">,</span> <span class="mo">0o0755</span><span class="p">)</span>

            <span class="c1"># It is possible for the user to specify and initial starting strain</span>
            <span class="c1"># rate that is already beyond the extinction strain rate for their</span>
            <span class="c1"># specified initial unburned gas. If a steady, burning flame is not</span>
            <span class="c1"># achieved at the initial strain rate, the initial strain rate is</span>
            <span class="c1"># reduced by a factor of 2 and convergence is tried again.</span>
            <span class="k">if</span> <span class="n">restartPath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">strainRate</span> <span class="o">/=</span> <span class="mf">2.0</span>
                <span class="k">if</span> <span class="n">strainRate</span> <span class="o">&lt;</span> <span class="mf">10.0</span><span class="p">:</span>
                    <span class="n">complete</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Failed to find burning starting point&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">readInitialCondition</span><span class="p">(</span><span class="n">restartPath</span><span class="p">)</span>

        <span class="c1"># A summary of the progression to extinction is saved. This is often</span>
        <span class="c1"># useful when evaluating qualitatively, whether the solution seems to</span>
        <span class="c1"># have converged to the extinction point.</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outDirTop</span><span class="p">,</span><span class="s1">&#39;extProfile.csv&#39;</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">extProgData</span><span class="p">:</span>
            <span class="n">extProgData</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Strain Rate [1/s],Max. Temp. [K]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">Tmax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">strainRateValues</span><span class="p">,</span> <span class="n">maxTemps</span><span class="p">):</span>
                <span class="n">extProgData</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:0.5f}</span><span class="s1">,</span><span class="si">{1:0.5f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">Tmax</span><span class="p">))</span>
            <span class="n">extProgData</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">_ember</span><span class="o">.</span><span class="n">FlameSolver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">multirun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a sequence of flame simulations at different strain rates using</span>
<span class="sd">        the parameters set in this Config object. The list of strain rates is</span>
<span class="sd">        defined by the configuration field :attr:`strainParameters.rates`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">confString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original</span><span class="o">.</span><span class="n">stringify</span><span class="p">()</span>
        <span class="n">strainRates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">rates</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">strainRates</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No strain rate list specified&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">rates</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">logFile</span><span class="p">:</span>
            <span class="n">_logFile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">logFile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
                <span class="n">_logFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="n">_logFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">_logFile</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span> <span class="mo">0o0755</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">initial</span> <span class="o">=</span> <span class="n">strainRates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">aSave</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Sc</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xFlame</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">fileExt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputFiles</span><span class="o">.</span><span class="n">fileExtension</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">strainRates</span><span class="p">:</span>
            <span class="n">aSave</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

            <span class="n">restartFile</span> <span class="o">=</span> <span class="s1">&#39;prof_eps</span><span class="si">{:04d}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">fileExt</span><span class="p">)</span>
            <span class="n">historyFile</span> <span class="o">=</span> <span class="s1">&#39;out_eps</span><span class="si">{:04d}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">fileExt</span><span class="p">)</span>
            <span class="n">configFile</span> <span class="o">=</span> <span class="s1">&#39;conf_eps</span><span class="si">{:04d}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">fileExt</span><span class="p">)</span>

            <span class="n">restartPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span> <span class="n">restartFile</span><span class="p">)</span>
            <span class="n">historyPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span> <span class="n">historyFile</span><span class="p">)</span>
            <span class="n">configPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span> <span class="n">configFile</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">restartPath</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">historyPath</span><span class="p">):</span>
                <span class="c1"># If the output files already exist, we simply retrieve the</span>
                <span class="c1"># integral flame properties from the existing profiles and</span>
                <span class="c1"># advance to the next strain rate.</span>

                <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Skipping run at strain rate a = </span><span class="si">%g</span><span class="s1">&#39;</span>
                    <span class="s1">&#39; because the output file &quot;</span><span class="si">%s</span><span class="s1">&quot; already exists.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">restartFile</span><span class="p">))</span>

                <span class="c1"># Compute integral properties using points from the last half</span>
                <span class="c1"># of the termination-check period</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">HDFStruct</span><span class="p">(</span><span class="n">historyPath</span><span class="p">)</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">t</span> <span class="o">&gt;</span> <span class="n">data</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">terminationCondition</span><span class="o">.</span><span class="n">steadyPeriod</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
                    <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Warning: old data file did not contain data&#39;</span>
                        <span class="s1">&#39; spanning the requested period.&#39;</span><span class="p">)</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>
                <span class="n">Sc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Sc</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>
                <span class="n">xFlame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">xFlame</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>
                <span class="k">del</span> <span class="n">data</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Data is not already present, so run the flame solver for this strain rate</span>

                <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Beginning run at strain rate a = </span><span class="si">%g</span><span class="s1"> s^-1&#39;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>
                <span class="n">confOut</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">configPath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
                <span class="n">confOut</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">confString</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">initial</span> <span class="o">=</span> <span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">strainParameters</span><span class="o">.</span><span class="n">final</span> <span class="o">=</span> <span class="n">a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">logFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span> <span class="s1">&#39;log-eps</span><span class="si">%04i</span><span class="s1">.txt&#39;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>
                <span class="n">log</span><span class="p">(</span><span class="s2">&quot;Writing output file for run to &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">logFile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">apply_options</span><span class="p">()</span>
                <span class="n">solver</span> <span class="o">=</span> <span class="n">_ember</span><span class="o">.</span><span class="n">FlameSolver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
                <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
                    <span class="n">done</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
                <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Completed run at strain rate a = </span><span class="si">%g</span><span class="s1"> s^-1&#39;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>
                <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Integration took </span><span class="si">%.1f</span><span class="s1"> seconds.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t2</span><span class="o">-</span><span class="n">t1</span><span class="p">))</span>

                <span class="n">solver</span><span class="o">.</span><span class="n">writeStateFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">restartFile</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">writeTimeseriesFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">historyFile</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">tRun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">timeseriesWriter</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
                <span class="n">QRun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">timeseriesWriter</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
                <span class="n">ScRun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">timeseriesWriter</span><span class="o">.</span><span class="n">Sc</span><span class="p">)</span>
                <span class="n">xFlameRun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">timeseriesWriter</span><span class="o">.</span><span class="n">xFlame</span><span class="p">)</span>

                <span class="c1"># Compute integral properties using points from the last half</span>
                <span class="c1"># of the termination-check period</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">tRun</span> <span class="o">&gt;</span> <span class="n">tRun</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">terminationCondition</span><span class="o">.</span><span class="n">steadyPeriod</span>
                <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">QRun</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>
                <span class="n">Sc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ScRun</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>
                <span class="n">xFlame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xFlameRun</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">readInitialCondition</span><span class="p">(</span><span class="n">restartPath</span><span class="p">)</span>

            <span class="c1"># Sort by strain rate:</span>
            <span class="n">aSave</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Sc</span><span class="p">,</span> <span class="n">xFlame</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aSave</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Sc</span><span class="p">,</span> <span class="n">xFlame</span><span class="p">))))</span>

            <span class="n">integralFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">outputDir</span><span class="p">,</span>
                <span class="s2">&quot;integral.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputFiles</span><span class="o">.</span><span class="n">fileExtension</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">integralFile</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">integralFile</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">output</span><span class="o">.</span><span class="n">OutputFile</span><span class="p">(</span><span class="n">integralFile</span><span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aSave</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Sc</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;xFlame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xFlame</span>

        <span class="k">return</span> <span class="n">_ember</span><span class="o">.</span><span class="n">FlameSolver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Ember 1.5.0b1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ember.input</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2008-2023, Raymond Speth.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>